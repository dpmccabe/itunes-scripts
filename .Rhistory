ptracks <- filter(chosen_tracks, chosen) %>%
select(-matches("chosen")) %>%
mutate(uuid = stringi::stri_rand_strings(n(), 10)) %>%
arrange(uuid) %>%
inner_join(
tracks %>% select(id, genre),
by = c("gid" = "id")
) %>%
group_by(genre_cat, rating) %>%
mutate(j = 1:n() - 1) %>%
mutate(j = j / max(j)) %>%
ungroup() %>%
mutate(j = ifelse(is.na(j), runif(n()), j)) %>%
group_by(genre_cat) %>%
mutate(gc_uuid = stringi::stri_rand_strings(1, 10))
ptracks <- filter(chosen_tracks, chosen) %>%
select(-matches("chosen")) %>%
mutate(uuid = stringi::stri_rand_strings(n(), 10)) %>%
arrange(uuid) %>%
inner_join(
tracks %>% select(id, genre),
by = c("gid" = "id")
) %>%
group_by(genre_cat, rating) %>%
mutate(j = 1:n() - 1) %>%
mutate(j = j / max(j)) %>%
ungroup() %>%
mutate(j = ifelse(is.na(j), runif(n()), j))
ptracks
ptracks %>% filter(genre_cat=="Other") %>% arrange(j)
filter(chosen_tracks, chosen) %>%
select(-matches("chosen")) %>%
mutate(uuid = stringi::stri_rand_strings(n(), 10)) %>%
arrange(uuid) %>%
inner_join(
tracks %>% select(id, genre),
by = c("gid" = "id")
) %>%
group_by(genre_cat, rating)
filter(chosen_tracks, chosen) %>%
select(-matches("chosen")) %>%
mutate(uuid = stringi::stri_rand_strings(n(), 10)) %>%
arrange(uuid) %>%
inner_join(
tracks %>% select(id, genre),
by = c("gid" = "id")
) %>%
group_by(genre_cat, rating) %>%
mutate(j = 1:n() - 1) %>%
mutate(j = j / max(j))
?lag
ptracks <- filter(chosen_tracks, chosen) %>%
select(-matches("chosen")) %>%
mutate(uuid = stringi::stri_rand_strings(n(), 10)) %>%
arrange(uuid) %>%
inner_join(
tracks %>% select(id, genre),
by = c("gid" = "id")
)
ptracks
ptracks <- filter(chosen_tracks, chosen) %>%
select(-matches("chosen")) %>%
mutate(uuid = stringi::stri_rand_strings(n(), 10)) %>%
arrange(uuid) %>%
inner_join(
tracks %>% select(id, genre),
by = c("gid" = "id")
) %>%
mutate(gc_rating = paste(genre_cat, rating, sep = "-"))
ptracks
ptracks_gcr <- split(ptracks, ptracks$gc_rating)
ptracks_gcr
d <- filter(ptracks_gcr, gc_rating=="Celtic-4")
d <- ptracks_gcr$`Celtic-4`
d
d %>%
arrange(uuid) %>%
mutate(j = 1:n() - 1) %>%
mutate(j = j / max(j))
d %>%
arrange(uuid) %>%
mutate(j = 1:n() - 1) %>%
mutate(j = j / max(j)) %>%
mutate(j = ifelse(is.na(j), runif(1), j))
d %>%
arrange(uuid) %>%
mutate(j = 1:n() - 1) %>%
mutate(j = j / max(j)) %>%
mutate(j = ifelse(is.na(j), runif(1), j)) %>%
mutate(
b1 = lag(j, default = 0),
b2 = lead(j, default = 1)
)
d %>%
arrange(uuid) %>%
mutate(j = 1:n() - 1) %>%
mutate(j = j / max(j)) %>%
mutate(j = ifelse(is.na(j), runif(1), j)) %>%
mutate(
b1 = lag(j, default = 0),
b2 = lead(j, default = 1)
) %>%
mutate(j = rnorn(n(), mean = (b1 + b2 / 2), sd = 0))
d %>%
arrange(uuid) %>%
mutate(j = 1:n() - 1) %>%
mutate(j = j / max(j)) %>%
mutate(j = ifelse(is.na(j), runif(1), j)) %>%
mutate(
b1 = lag(j, default = 0),
b2 = lead(j, default = 1)
) %>%
mutate(j = rnorm(n(), mean = (b1 + b2 / 2), sd = 0))
d %>%
arrange(uuid) %>%
mutate(j = 1:n() - 1) %>%
mutate(j = j / max(j)) %>%
mutate(j = ifelse(is.na(j), runif(1), j)) %>%
mutate(
b1 = lag(j, default = 0),
b2 = lead(j, default = 1)
) %>%
mutate(k = rnorm(n(), mean = (b1 + b2 / 2), sd = 0))
d %>%
arrange(uuid) %>%
mutate(j = 1:n() - 1) %>%
mutate(j = j / max(j)) %>%
mutate(j = ifelse(is.na(j), runif(1), j)) %>%
mutate(
b1 = lag(j, default = 0),
b2 = lead(j, default = 1)
) %>%
mutate(k = rnorm(n(), mean = (b1 + b2) / 2, sd = 0))
ptracks_gcr
ptracks_gcr_j <- lapply(ptracks_gcr, interleave)
interleave <- function(d) {
d %>%
arrange(uuid) %>%
mutate(j = 1:n() - 1) %>%
mutate(j = j / max(j)) %>%
mutate(j = ifelse(is.na(j), runif(1), j)) %>%
mutate(
b1 = lag(j, default = 0),
b2 = lead(j, default = 1)
) %>%
mutate(j = rnorm(n(), mean = (b1 + b2) / 2, sd = 0))
}
ptracks_gcr_j <- lapply(ptracks_gcr, interleave)
ptracks_gcr_j
interleave <- function(d) {
d %>%
arrange(uuid) %>%
mutate(j = 1:n() - 1) %>%
mutate(j = j / max(j)) %>%
mutate(j = ifelse(is.na(j), runif(1), j)) %>%
mutate(
b1 = lag(j, default = 0),
b2 = lead(j, default = 1)
) %>%
mutate(k = rnorm(n(), mean = (b1 + b2) / 2, sd = 0))
}
ptracks_gcr_j <- lapply(ptracks_gcr, interleave)
ptracks_gcr_j
ptracks_joined <- rbind_all(ptracks_gcr_j)
ptracks_joined <- bind_rows(ptracks_gcr_j)
ptracks_joined
ptracks_joined <- bind_rows(ptracks_gcr_j) %>%
group_by(genre_cat) %>%
arrange(genre_cat, k) %>%
mutate(l = 1:n()) %>%
ungroup()
ptracks_joined
ptracks_joined %>% filter(genre_cat=="Other") %>% arrange(j)
ptracks_joined %>% filter(genre_cat=="Other") %>% arrange(l)
d <- ptracks_gcr$`Celtic-4`
d
d <- ptracks_gcr$`Other-4`
d
d %>%
arrange(uuid) %>%
mutate(j = 1:n() - 1) %>%
mutate(j = j / max(j)) %>%
mutate(j = ifelse(is.na(j), runif(1), j)) %>%
mutate(
b1 = lag(j, default = 0),
b2 = lead(j, default = 1)
) %>%
mutate(k = rnorm(n(), mean = (b1 + b2) / 2, sd = 0))
d %>%
arrange(uuid) %>%
mutate(j = 1:n()) %>%
mutate(j = j / max(j))
d %>%
arrange(uuid) %>%
mutate(j = 1:n()) %>%
mutate(j = j / max(j))
d %>%
arrange(uuid) %>%
mutate(j = 1:n() - 1) %>%
mutate(j = j / max(j))
d %>%
arrange(uuid) %>%
mutate(j = 1:n() - 1) %>%
mutate(j = j / max(j)) %>%
mutate(j = ifelse(is.na(j), runif(1), j)) %>%
mutate(
b1 = lag(j, default = 0),
b2 = lead(j, default = 1)
)
d %>%
arrange(uuid) %>%
mutate(j = 1:n() / n())
d %>%
arrange(uuid) %>%
mutate(j = 1:n() / n()) %>%
mutate(
b1 = lag(j, default = 0),
b2 = lead(j, default = 1)
)
d %>%
arrange(uuid) %>%
mutate(j = 1:n() / n()) %>%
mutate(
b1 = lag(j, default = 0),
b2 = j
)
d %>%
arrange(uuid) %>%
mutate(j = 1:n() / n()) %>%
mutate(
b1 = lag(j, default = 0),
b2 = j
) %>%
mutate(k = rnorm(n(), mean = (b1 + b2) / 2, sd = 0))
d %>%
arrange(uuid) %>%
mutate(j = 1:n() / n()) %>%
mutate(
b1 = lag(j, default = 0),
b2 = j
) %>%
mutate(j = rnorm(n(), mean = (b1 + b2) / 2, sd = 0))
d <- ptracks_gcr$`Classical-4`
d
d %>%
arrange(uuid) %>%
mutate(j = 1:n() / n()) %>%
mutate(
b1 = lag(j, default = 0),
b2 = j
) %>%
mutate(j = rnorm(n(), mean = (b1 + b2) / 2, sd = 0)) %>%
select(-b1, -b2)
d %>%
arrange(uuid) %>%
mutate(j = 1:n() / n()) %>%
mutate(
b1 = lag(j, default = 0),
b2 = j
) %>%
mutate(j = rnorm(n(), mean = (b1 + b2) / 2, sd = 0))
interleave <- function(d) {
d %>%
arrange(uuid) %>%
mutate(j = 1:n() / n()) %>%
mutate(
b1 = lag(j, default = 0),
b2 = j
) %>%
mutate(j = rnorm(n(), mean = (b1 + b2) / 2, sd = 0)) %>%
select(-b1, -b2)
}
ptracks_gcr_j <- lapply(ptracks_gcr, interleave)
bind_rows(ptracks_gcr_j) %>%
group_by(genre_cat) %>%
arrange(genre_cat, k)
ptracks_joined <- bind_rows(ptracks_gcr_j) %>%
group_by(genre_cat) %>%
arrange(genre_cat, j)
ptracks_joined <- bind_rows(ptracks_gcr_j) %>%
group_by(genre_cat) %>%
arrange(genre_cat, j) %>%
mutate(l = 1:n())
ptracks_joined <- bind_rows(ptracks_gcr_j) %>%
group_by(genre_cat) %>%
arrange(genre_cat, j) %>%
mutate(l = 1:n()) %>%
ungroup()
ptracks_joined %>% filter(genre_cat=="Other") %>% arrange(l)
ptracks_joined %>% filter(genre_cat=="Celtic") %>% arrange(l)
ptracks_joined
ptracks_gc <- split(ptracks_joined, ptracks_joined$genre_cat)
ptracks_gc
arrange_col="uuid"
d
d %>%
arrange_(arrange_col) %>%
mutate(j = 1:n() / n()) %>%
mutate(
b1 = lag(j, default = 0),
b2 = j
) %>%
mutate(j = rnorm(n(), mean = (b1 + b2) / 2, sd = 0)) %>%
select(-b1, -b2)
d <- ptracks_gcr$`Classical-3`
d %>%
arrange_(arrange_col) %>%
mutate(j = 1:n() / n()) %>%
mutate(
b1 = lag(j, default = 0),
b2 = j
) %>%
mutate(j = rnorm(n(), mean = (b1 + b2) / 2, sd = 0)) %>%
select(-b1, -b2)
interleave <- function(d, arrange_col) {
d %>%
arrange_(arrange_col) %>%
mutate(j = 1:n() / n()) %>%
mutate(
b1 = lag(j, default = 0),
b2 = j
) %>%
mutate(j = rnorm(n(), mean = (b1 + b2) / 2, sd = 0)) %>%
select(-b1, -b2)
}
ptracks_gcr_j <- lapply(ptracks_gcr, interleave, arrange_col = "uuid")
ptracks_joined <- bind_rows(ptracks_gcr_j) %>%
group_by(genre_cat) %>%
arrange(genre_cat, j) %>%
mutate(l = 1:n()) %>%
ungroup()
ptracks_joined %>% filter(genre_cat=="Celtic") %>% arrange(l)
d <- ptracks_gc$`Celtic`
d
arrange_col="l"
d %>%
arrange_(arrange_col) %>%
mutate(j = 1:n() / n()) %>%
mutate(
b1 = lag(j, default = 0),
b2 = j
) %>%
mutate(j = rnorm(n(), mean = (b1 + b2) / 2, sd = 0)) %>%
select(-b1, -b2)
d %>%
arrange_(arrange_col) %>%
mutate(j = 1:n() / n()) %>%
mutate(
b1 = lag(j, default = 0),
b2 = j
) %>%
mutate(j = rnorm(n(), mean = (b1 + b2) / 2, sd = 0))
interleave <- function(d, arrange_col) {
d %>%
arrange_(arrange_col) %>%
mutate(j = 1:n() / n()) %>%
mutate(
b1 = lag(j, default = 0),
b2 = j
) %>%
mutate(j = rnorm(n(), mean = (b1 + b2) / 2, sd = 0)) %>%
select(-b1, -b2)
}
ptracks_gc_j <- lapply(ptracks_gc, interleave, arrange_col = "l")
ptracks_gc_j
ptracks_joined <- bind_rows(ptracks_gc_j)
ptracks_joined
ptracks_joined <- bind_rows(ptracks_gc_j) %>%
select(-gc_rating, -l)
ptracks_joined
exploded_tracks <- bind_rows(tracks_ungrouped, tracks_grouped) %>%
select(gid, id, no) %>%
inner_join(ptracks, by = "gid") %>%
mutate(id = ifelse(is.na(id), gid, id)) %>%
arrange(j, no)
ptracks_joined
exploded_tracks <- bind_rows(tracks_ungrouped, tracks_grouped) %>%
select(gid, id, no) %>%
inner_join(ptracks_joined, by = "gid") %>%
mutate(id = ifelse(is.na(id), gid, id)) %>%
arrange(j, no)
exploded_tracks
ptracks_gcr <- split(ptracks, ptracks$gc_rating)
d <- ptracks_gcr$`Classical-3`
d %>%
arrange_(arrange_col) %>%
mutate(j = 1:n() / n()) %>%
mutate(
b1 = lag(j, default = 0),
b2 = j
) %>%
mutate(j = runif(n(), b1, b2)) %>%
select(-b1, -b2)
arrange_col="uuid"
d %>%
arrange_(arrange_col) %>%
mutate(j = 1:n() / n()) %>%
mutate(
b1 = lag(j, default = 0),
b2 = j
) %>%
mutate(j = runif(n(), b1, b2)) %>%
select(-b1, -b2)
d %>%
arrange_(arrange_col) %>%
mutate(j = 1:n() / n()) %>%
mutate(
b1 = lag(j, default = 0),
b2 = j
) %>%
mutate(j = runif(n(), b1, b2))
interleave <- function(d, arrange_col) {
d %>%
arrange_(arrange_col) %>%
mutate(j = 1:n() / n()) %>%
mutate(
b1 = lag(j, default = 0),
b2 = j
) %>%
mutate(j = runif(n(), b1, b2)) %>%
select(-b1, -b2)
}
ptracks_gcr_j <- lapply(ptracks_gcr, interleave, arrange_col = "uuid")
ptracks_joined <- bind_rows(ptracks_gcr_j) %>%
group_by(genre_cat) %>%
arrange(genre_cat, j) %>%
mutate(l = 1:n()) %>%
ungroup()
ptracks_joined %>% filter(genre_cat=="Celtic") %>% arrange(l)
ptracks <- filter(chosen_tracks, chosen) %>%
select(-matches("chosen")) %>%
mutate(uuid = stringi::stri_rand_strings(n(), 10)) %>%
arrange(uuid) %>%
inner_join(
tracks %>% select(id, genre),
by = c("gid" = "id")
) %>%
mutate(gc_rating = paste(genre_cat, rating, sep = "-"))
ptracks_gcr <- split(ptracks, ptracks$gc_rating)
interleave <- function(d, arrange_col) {
d %>%
arrange_(arrange_col) %>%
mutate(j = 1:n() / n()) %>%
mutate(
b1 = lag(j, default = 0),
b2 = j
) %>%
mutate(j = runif(n(), b1, b2)) %>%
select(-b1, -b2)
}
ptracks_gcr_j <- lapply(ptracks_gcr, interleave, arrange_col = "uuid")
ptracks_joined <- bind_rows(ptracks_gcr_j) %>%
group_by(genre_cat) %>%
arrange(genre_cat, j) %>%
mutate(l = 1:n()) %>%
ungroup()
ptracks_gc <- split(ptracks_joined, ptracks_joined$genre_cat)
ptracks_gc_j <- lapply(ptracks_gc, interleave, arrange_col = "l")
ptracks_gc_j
ptracks_joined <- bind_rows(ptracks_gc_j) %>%
select(-gc_rating, -l)
ptracks_joined
ggplot(ptracks_joined, aes(x = j, y = 1, color = genre_cat)) +
geom_point()
library(ggplot2)
ggplot(ptracks_joined, aes(x = j, y = 1, color = genre_cat)) +
geom_point()
ptracks_joined
ptracks_joined <- bind_rows(ptracks_gc_j)
ggplot(ptracks_joined, aes(x = l, y = 1, color = genre_cat)) +
geom_point()
ggplot(ptracks_joined, aes(x = l, y = 0, color = genre_cat)) +
geom_point() +
theme_few()
library(ggthemes)
ggplot(ptracks_joined, aes(x = l, y = 0, color = genre_cat)) +
geom_point() +
theme_few()
ptracks_joined
ggplot(ptracks_joined, aes(x = rank(j), y = 0, color = genre_cat)) +
geom_point() +
theme_few()
ggplot(ptracks_joined, aes(x = rank(j), y = 0, color = genre_cat, text = rating)) +
geom_text() +
theme_few()
ggplot(ptracks_joined, aes(x = rank(j), y = 0, color = genre_cat, label = rating)) +
geom_text() +
theme_few()
exploded_tracks <- bind_rows(tracks_ungrouped, tracks_grouped) %>%
select(gid, id, no) %>%
inner_join(ptracks_joined, by = "gid") %>%
mutate(id = ifelse(is.na(id), gid, id)) %>%
arrange(j, no)
ptracks <- filter(chosen_tracks, chosen) %>%
select(-matches("chosen")) %>%
mutate(uuid = stringi::stri_rand_strings(n(), 10)) %>%
arrange(uuid) %>%
inner_join(
tracks %>% select(id, genre),
by = c("gid" = "id")
) %>%
mutate(gc_rating = paste(genre_cat, rating, sep = "-"))
ptracks
ggplot(ptracks_joined, aes(x = rank(j), y = 0, color = genre_cat, label = rating)) +
geom_text() +
theme_few()
ggplot(ptracks_joined, aes(x = rank(j), y = rating, color = genre_cat, label = rating)) +
geom_text() +
theme_few()
ggplot(ptracks_joined, aes(x = rank(j), y = rating, color = genre_cat)) +
geom_point() +
theme_few()
